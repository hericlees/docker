# Exemplo de criaÃ§Ã£o de uma imagem em node

FROM node:14
WORKDIR /app-node
COPY . .
RUN npm install
ENTRYPOINT npm start


Esse Ã© um **Dockerfile**, que Ã© um arquivo usado para **criar imagens de contÃªineres** no Docker. Vamos analisar cada instruÃ§Ã£o:

1. **`FROM node:14`**:
    - Essa instruÃ§Ã£o define a **imagem base** para o contÃªiner. Neste caso, estamos usando a imagem oficial do **Node.js** na versÃ£o **14**.
    - O contÃªiner serÃ¡ construÃ­do com base nessa imagem, que jÃ¡ inclui o Node.js e outras dependÃªncias.

2. **`WORKDIR /app-node`**:
    - Essa instruÃ§Ã£o define o **diretÃ³rio de trabalho** dentro do contÃªiner.
    - Todos os comandos subsequentes serÃ£o executados a partir desse diretÃ³rio.
    - No caso, estamos definindo o diretÃ³rio como `/app-node`.

3. **`COPY . .`**:
    - Essa instruÃ§Ã£o copia os arquivos do **diretÃ³rio atual** (onde o Dockerfile estÃ¡ localizado) para o diretÃ³rio de trabalho dentro do contÃªiner.
    - O primeiro ponto (`.`) refere-se ao **diretÃ³rio de origem** (atual), e o segundo ponto (`.`) refere-se ao **diretÃ³rio de destino** (diretÃ³rio de trabalho).

4. **`RUN npm install`**:
    - Essa instruÃ§Ã£o executa o comando `npm install` dentro do contÃªiner.
    - Ela instala as **dependÃªncias do aplicativo Node.js** especificadas no arquivo `package.json`.
    - Isso Ã© importante para garantir que todas as bibliotecas necessÃ¡rias estejam disponÃ­veis no contÃªiner.

5. **`ENTRYPOINT npm start`**:
    - Essa instruÃ§Ã£o define o **comando de entrada** para o contÃªiner.
    - Quando o contÃªiner Ã© iniciado, ele executarÃ¡ o comando `npm start`.
    - Isso geralmente Ã© usado para iniciar o servidor ou aplicativo dentro do contÃªiner.

Em resumo, esse Dockerfile cria um contÃªiner baseado na imagem do Node.js 14, copia os arquivos do diretÃ³rio atual para o diretÃ³rio de trabalho no contÃªiner, instala as dependÃªncias e, ao iniciar o contÃªiner, executa o comando `npm start` para iniciar o aplicativo Node.js. ğŸ³ğŸš€

Origem: 
(1) Dockerizing a Node.js App: A Comprehensive Guide for Easy Deployment. https://dev.to/burakboduroglu/dockerizing-a-nodejs-app-a-comprehensive-guide-for-easy-deployment-13o1.
(2) [DÃºvida] Erro na execuÃ§Ã£o do container node | FÃ³rum Alura. https://cursos.alura.com.br/forum/topico-duvida-erro-na-execucao-do-container-node-282268.
(3) Crafting multi-stage builds with Docker in Node.js - DEV Community. https://www.cloudnweb.dev/2019/10/crafting-multi-stage-builds-with-docker-in-node-js/.
(4) Copy output of npm install to docker container - Stack Overflow. https://stackoverflow.com/questions/63225434/copy-output-of-npm-install-to-docker-container.
(5) What is the point of WORKDIR on Dockerfile? - Stack Overflow. https://stackoverflow.com/questions/51066146/what-is-the-point-of-workdir-on-dockerfile.
(6) How To Build a Node.js Application with Docker | DigitalOcean. https://www.digitalocean.com/community/tutorials/how-to-build-a-node-js-application-with-docker.


# Para criar um nome, ou seja, etiquetar a nossa imagem

docker build -t danielartine/app-node:1 .


# Para alterar a porta. Ex.: 3000 para 8081

docker run -d â€“p 8081:3000 danielartine/app-node:1.0

# Para expor a porta, sÃ³ adcionar o expose e o nÂº da porta

FROM node:14
WORKDIR /app-node
EXPOSE 3000
COPY . .
RUN npm install
ENTRYPOINT npm start


# Criando a conta no Docker Hub

Primeiro, Ã© necessÃ¡rio que vocÃª crie uma conta na parte direita da home do Docker Hub. Insira seu nome de usuÃ¡rio, e-mail, senha, aceite os termos e marque a opÃ§Ã£o recaptcha. 
Depois, clique em "Sign up" e confirme sua conta por e-mail.


# Autenticando a conta do Docker Hub

Precisamos voltar ao nosso terminal e autenticar a nossa conta no Command Line Interface (Interface de Linha de Comando) do Docker, para que ele saiba que somos.

Para isso, usamos o comando 

docker login -u nomedousuÃ¡rio

Ao pressionar "Enter", serÃ¡ solicitada a senha (password) que usou durante o cadastro no Docker Hub. Por questÃµes de seguranÃ§a, o nÃºmero de caracteres nÃ£o aparecerÃ¡, mas estarÃ¡ sendo digitado.


# Subindo a imagem para o Docker Hub

docker push nomedousuario/imagemcriada:1.0

O comando `docker push` Ã© usado para **enviar** (ou **empurrar**) **imagens Docker** para um **repositÃ³rio**. Vamos entender o que cada parte desse comando significa:

1. **`docker`**: Refere-se ao utilitÃ¡rio de linha de comando do Docker.
2. **`push`**: Ã‰ o subcomando que indica que queremos enviar uma imagem para um repositÃ³rio.
3. **`nomedousuario/imagemcriada:1.0`**: Ã‰ a **tag** da imagem que estamos enviando. Vamos quebrar isso em partes:
    - **`nomedousuario`**: Ã‰ o nome do **repositÃ³rio** (ou **registry**). Pode ser um registro pÃºblico como o Docker Hub ou um registro privado.
    - **`imagemcriada`**: Ã‰ o nome da **imagem** que estamos enviando.
    - **`:1.0`**: Ã‰ a **tag** especÃ­fica dessa imagem. Neste caso, estamos enviando a versÃ£o `1.0`.

Aqui estÃ¡ o fluxo geral do que acontece quando vocÃª executa `docker push`:

1. VocÃª **constrÃ³i** uma imagem Docker localmente (por exemplo, usando `docker build`).
2. Essa imagem Ã© **marcada** com uma **tag** especÃ­fica (como `1.0`).
3. VocÃª executa `docker push` para enviar essa imagem para um **repositÃ³rio** (como o Docker Hub).
4. O Docker envia a imagem para o repositÃ³rio especificado, tornando-a disponÃ­vel para outras pessoas ou mÃ¡quinas.

Em resumo, o comando `docker push` Ã© usado para **distribuir** suas imagens Docker para que outros possam usÃ¡-las ou implantÃ¡-las em seus prÃ³prios ambientes. Ã‰ uma parte fundamental do ciclo de vida de desenvolvimento e implantaÃ§Ã£o de contÃªineres. ğŸ³ğŸš€

Origem: conversa com o Bing, 11/04/2024
(1) Docker: How to authenticate for docker push? - Stack Overflow. https://stackoverflow.com/questions/34434231/docker-how-to-authenticate-for-docker-push.
(2) Building and Dockerizing a Node.js | by Liliane Konissi | Medium. https://medium.com/@lilnya79/building-and-dockerizing-a-node-js-app-from-scratch-and-pushing-it-to-docker-hub-201451967720.
(3) How To Build a Node.js Application with Docker | DigitalOcean. https://www.digitalocean.com/community/tutorials/how-to-build-a-node-js-application-with-docker.
(4) undefined. https://docs.docker.com/mac/step_six/.
